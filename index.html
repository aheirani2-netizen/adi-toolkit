<script>
document.addEventListener("DOMContentLoaded", function () {

    /* Student storage */
    let pupils = JSON.parse(localStorage.getItem("pupils") || "[]");
    const pupilSelect = document.getElementById("pupilSelect");

    function refreshPupils() {
        pupilSelect.innerHTML = "";
        pupils.forEach((p, i) => {
            const option = document.createElement("option");
            option.value = i;
            option.textContent = p.name;
            pupilSelect.appendChild(option);
        });
    }

    window.addPupil = function () {
        const name = prompt("Enter student name:");
        if (!name) return;
        pupils.push({ name });
        localStorage.setItem("pupils", JSON.stringify(pupils));
        refreshPupils();
    };

    window.deletePupil = function () {
        const index = pupilSelect.value;
        if (index === "") return;
        pupils.splice(index, 1);
        localStorage.setItem("pupils", JSON.stringify(pupils));
        refreshPupils();
    };

    window.saveLesson = function () {
        alert("Lesson saved locally.");
    };

    refreshPupils();


    /* Scale bars */
    function createScale(id) {
        const container = document.getElementById(id);
        for (let i = 1; i <= 10; i++) {
            const div = document.createElement("div");
            div.innerText = i;
            div.onclick = () => {
                [...container.children].forEach(c => c.classList.remove("selected"));
                div.classList.add("selected");
                updateMovedText();
            };
            container.appendChild(div);
        }
    }

    function getScaleValue(id) {
        const selected = document.querySelector(`#${id} .selected`);
        return selected ? selected.innerText : "__";
    }

    function updateMovedText() {
        document.getElementById("fromScore").innerText = getScaleValue("scale1");
        document.getElementById("toScore").innerText = getScaleValue("scale2");
    }

    createScale("scale1");
    createScale("scale2");

});
</script>