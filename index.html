<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADI Instructor Toolkit</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body {
    font-family: Arial, sans-serif;
    padding: 20px;
    max-width: 900px;
    margin: auto;
    transition: 0.3s;
}

h1, h2 {
    text-align: center;
}

textarea, input, select {
    width: 100%;
    padding: 8px;
    margin-bottom: 15px;
    font-size: 16px;
}

button {
    padding: 12px;
    width: 100%;
    margin-bottom: 10px;
    font-size: 16px;
}

.section {
    border-top: 1px solid #ccc;
    padding-top: 15px;
    margin-top: 20px;
}

.dark {
    background-color: #1c1c1e;
    color: white;
}

.dark textarea,
.dark input,
.dark select {
    background-color: #2c2c2e;
    color: white;
    border: 1px solid #444;
}
</style>
</head>

<body>

<h1>ADI Instructor Toolkit</h1>
<h2>Instructor: Alex Heirani</h2>

<p><strong>Date:</strong> <span id="date"></span></p>

<div class="section">
<label>Select / Add Pupil</label>
<select id="pupilSelect" onchange="loadPupil()"></select>
<input type="text" id="newPupil" placeholder="Add New Pupil">
<button onclick="addPupil()">Add Pupil</button>
</div>

<div class="section">
<label>Lesson Objective</label>
<textarea id="objective"></textarea>

<label>Self Evaluation (1â€“10)</label>
<input type="number" id="rating" min="1" max="10" value="5">

<label>Strengths</label>
<textarea id="strengths"></textarea>

<label>Development Areas</label>
<textarea id="development"></textarea>

<label>Agreed Action Plan</label>
<textarea id="action"></textarea>
</div>

<div class="section">
<h3>Risk Management</h3>
<select id="risk">
<option value="Low">Low Risk</option>
<option value="Medium">Medium Risk</option>
<option value="High">High Risk</option>
</select>
</div>

<div class="section">
<h3>ADI Part 3 Competency Tracker</h3>
<div id="competencies"></div>
</div>

<div class="section">
<button onclick="saveLesson()">Save Lesson</button>
<button onclick="generatePDF()">Generate Professional PDF</button>
<button onclick="emailReport()">Email Report</button>
<button onclick="toggleDark()">Toggle Dark Mode</button>
</div>

<script>
document.getElementById("date").innerText =
new Date().toLocaleDateString('en-GB', { day:'numeric', month:'long', year:'numeric' });

const competencies = [
"Lesson Planning",
"Risk Management",
"Client-Centred Learning",
"Communication",
"Feedback Quality",
"Instruction Clarity",
"Adaptability",
"Safety Awareness",
"Independent Driving",
"Fault Identification",
"Remedial Action",
"Pupil Engagement",
"Goal Setting",
"Progress Tracking",
"Professionalism",
"Time Management",
"Reflective Practice"
];

competencies.forEach((c, i) => {
    document.getElementById("competencies").innerHTML +=
    `<label><input type="checkbox" id="comp${i}"> ${c}</label><br>`;
});

function addPupil() {
    const name = document.getElementById("newPupil").value;
    if (!name) return;
    let pupils = JSON.parse(localStorage.getItem("pupils") || "[]");
    pupils.push(name);
    localStorage.setItem("pupils", JSON.stringify(pupils));
    loadPupilList();
    document.getElementById("newPupil").value = "";
}

function loadPupilList() {
    let pupils = JSON.parse(localStorage.getItem("pupils") || "[]");
    let select = document.getElementById("pupilSelect");
    select.innerHTML = "";
    pupils.forEach(p => {
        select.innerHTML += `<option value="${p}">${p}</option>`;
    });
}

function saveLesson() {
    const pupil = document.getElementById("pupilSelect").value;
    if (!pupil) return alert("Select a pupil");

    const lesson = {
        date: document.getElementById("date").innerText,
        objective: objective.value,
        rating: rating.value,
        strengths: strengths.value,
        development: development.value,
        action: action.value,
        risk: risk.value
    };

    localStorage.setItem("lesson_" + pupil, JSON.stringify(lesson));
    alert("Lesson saved");
}

function generatePDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    doc.setFontSize(16);
    doc.text("DVSA LESSON RECORD", 20, 20);

    doc.setFontSize(12);
    doc.text("Instructor: Alex Heirani", 20, 30);
    doc.text("Date: " + document.getElementById("date").innerText, 20, 38);

    let y = 50;
    function addSection(title, content) {
        doc.setFont(undefined, "bold");
        doc.text(title, 20, y);
        y += 8;
        doc.setFont(undefined, "normal");
        doc.text(doc.splitTextToSize(content, 170), 20, y);
        y += 20;
    }

    addSection("Lesson Objective", objective.value);
    addSection("Self Evaluation", rating.value + " / 10");
    addSection("Strengths", strengths.value);
    addSection("Development Areas", development.value);
    addSection("Action Plan", action.value);
    addSection("Risk Level", risk.value);

    doc.save("DVSA_Lesson_Record.pdf");
}

function emailReport() {
    const body = "Please find attached your lesson record.";
    window.location.href = "mailto:?subject=DVSA Lesson Record&body=" + encodeURIComponent(body);
}

function toggleDark() {
    document.body.classList.toggle("dark");
}

loadPupilList();
</script>

</body>
</html>
